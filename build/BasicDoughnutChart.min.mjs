class BasicDoughnutChart{constructor(t,e,s){this.default={options:{height:0,width:0,strokeWidth:40,margin:0,labels:!0,borderEffect:{strokeWidth:0,distance:0}},data:{values:[],actives:[],classes:[],colors:[]}},this.id=t,this.options=this.getOptions(e),this.data=this.getData(s),this.chart=document.getElementById(this.id),this.classes=this.defineClassesForElements(),this.ids=this.defineIdsForElements(),0===this.data.colors.length&&this.createRandomColors()}getOptions=(t={})=>({...this.default.options,...t});getData=t=>{let e={...this.default.data,...t};const s=e.values.reduce((t,e)=>t+e);return 100!==s&&(e.values=e.values.map(t=>t/s*100)),e};defineClassesForElements=()=>({wrapper:"bdc__wrapper",path:"bdc__path",pathActive:"bdc__path--active",borderWrapper:"bdc__wrapper-border",border:"bdc__border",borderShow:"bdc__border--show",label:"bdc__label"});defineIdsForElements=()=>({svgChart:this.id+"--element",clipPath:this.id+"--clipPath",borderWrapper:this.id+"--wrapper-border",borderSVG:this.id+"--border"});createRandomColors=()=>{for(const e of this.data.values){var t="#"+this.createRandomHexNumber(6);this.data.colors.push(t)}return this};getTotalSizeOfChartWithoutBorder=()=>({width:this.options.borderEffect.distance<0?this.getTotalSizeOfChartWithBorder().width:this.options.width-2*this.options.borderEffect.distance-2*this.options.borderEffect.strokeWidth,height:this.options.borderEffect.distance<0?this.getTotalSizeOfChartWithBorder().height:this.options.height-2*this.options.borderEffect.distance-2*this.options.borderEffect.strokeWidth});getTotalSizeOfChartWithBorder=()=>({width:this.options.width-this.options.borderEffect.strokeWidth,height:this.options.height-this.options.borderEffect.strokeWidth});draw=()=>{var t=this.getTotalSizeOfChartWithoutBorder().width,e=this.getTotalSizeOfChartWithoutBorder().height;this.chart.classList.add(this.classes.wrapper),this.chart.style.width=this.options.width+"px",this.chart.style.height=this.options.height+"px";const s=this.createChartSVG(t,e);var r=this.createClipElement(t,e);let[i,a]=[0,0];for(const o of this.data.values){var h=this.createPathSegments(o,t,i,a);s.append(r,h),this.options.labels&&this.drawLabels(i,o,t,e),i+=o,a++}return this.chart.append(s),this.options.borderEffect&&this.drawBorder(this.chart),this};drawBorder=()=>{var t=this.getTotalSizeOfChartWithBorder().width,e=this.getTotalSizeOfChartWithBorder().height;const s=this.createBorderSVG(t,e);for(const i of document.querySelectorAll(`#${this.ids.svgChart} > path`)){var r=this.createBorderSegment(i,t);s.appendChild(r)}return this.chart.appendChild(s),this};drawLabels(t,e,s){let r,i,a;s=s/2-this.options.strokeWidth/2,t=3.6*t+3.6*(e-this.options.margin)/2;t<90?(a=t,i=s*Math.cos(a*(Math.PI/180))*-1,r=Math.sqrt(Math.pow(s,2)-Math.pow(i,2))):t<180?(a=t-90,r=s*Math.cos(a*(Math.PI/180)),i=Math.sqrt(Math.pow(s,2)-Math.pow(r,2))):t<270?(a=t-180,i=s*Math.cos(a*(Math.PI/180)),r=-1*Math.sqrt(Math.pow(s,2)-Math.pow(i,2))):t<360&&(a=t-270,r=s*Math.cos(a*(Math.PI/180))*-1,i=-1*Math.sqrt(Math.pow(s,2)-Math.pow(r,2)));const h=document.createElement("span");return h.classList.add(this.classes.label),h.innerHTML=Math.round(e)+"%",h.style.transform=`translateX(${r}px) translateY(${i}px)`,this.chart.appendChild(h),this}showBorder(t){let e=document.getElementById(this.id+"--border-"+t.getAttribute("chart:path"));this.options.borderEffect.distance<0?(e.style.transition="0.4s stroke-width",e.style.opacity="1"):e.style.transition="0.2s opacity",t.classList.contains(this.classes.pathActive)||(e.style.strokeWidth=this.options.borderEffect.strokeWidth+"px",e.classList.toggle(this.classes.borderShow)),e.style.transform=`rotate(${t.getAttribute("chart:rotate")}deg)`}hideBorder(t){let e=document.getElementById(this.id+"--border-"+t.getAttribute("chart:path"));t.classList.contains(this.classes.pathActive)||(e.style.transform=`rotate(${t.getAttribute("chart:rotate")}deg)`,e.classList.toggle("bdc__border--show"),this.options.borderEffect.distance<=0&&(e.style.strokeWidth="0px"))}createChartSVG=(t,e)=>{const s=document.createElementNS("http://www.w3.org/2000/svg","svg");return s.id=this.ids.svgChart,s.setAttribute("viewBox",`0 0 ${t} `+e),s.style.width=t+"px",s.style.height=e+"px",s};createPathSegments=(t,e,s,r)=>{const i=document.createElementNS("http://www.w3.org/2000/svg","path");i.setAttribute("chart:path",this.id+" path-"+r),i.setAttribute("d",`M${e/2} 0 a ${e/2} ${e/2} 0 0 1 0 ${e} a ${e/2} ${e/2} 0 0 1 0 -`+e),i.setAttribute("stroke",""+this.data.colors[r]),i.setAttribute("stroke-width",""+2*this.options.strokeWidth),i.setAttribute("clip-path",`url(#${this.ids.clipPath})`),i.setAttribute("chart:rotate",""+3.6*s),i.setAttribute("chart:value",""+t),i.style.transform=`rotate(${3.6*s}deg`;e=(t-this.options.margin)/100*i.getTotalLength();return i.setAttribute("stroke-dasharray",e+", "+i.getTotalLength()),this.data.classes[r]?i.classList.add(this.data.classes[r],this.classes.path):i.classList.add(this.classes.path),this.data.actives[r]&&i.classList.add(this.classes.pathActive),this.options.borderEffect&&(i.addEventListener("mouseover",this.showBorder.bind(this,i)),i.addEventListener("mouseout",this.hideBorder.bind(this,i))),i};createClipElement=(t,e)=>{const s=document.createElementNS("http://www.w3.org/2000/svg","defs"),r=document.createElementNS("http://www.w3.org/2000/svg","clipPath"),i=(r.id=this.ids.clipPath,document.createElementNS("http://www.w3.org/2000/svg","circle"));return i.setAttribute("cx",""+t/2),i.setAttribute("cy",""+e/2),i.setAttribute("r",""+e/2),r.appendChild(i),s.appendChild(r),s};createBorderSVG=(t,e)=>{const s=document.createElementNS("http://www.w3.org/2000/svg","svg");return s.id=this.ids.borderSVG,s.classList.add(this.classes.borderWrapper),s.setAttribute("viewBox",`0 0 ${t} `+e),s.style.width=t+"px",s.style.height=e+"px",s};createBorderSegment=(t,e)=>{const s=document.createElementNS("http://www.w3.org/2000/svg","path");s.id=this.id+"--border-"+t.getAttribute("chart:path"),s.classList.add(this.classes.border),s.setAttribute("d",`M${e/2} 0 a ${e/2} ${e/2} 0 0 1 0 ${e} a ${e/2} ${e/2} 0 0 1 0 -`+e),s.setAttribute("stroke-width",""+this.options.borderEffect.strokeWidth),s.setAttribute("stroke",""+t.getAttribute("stroke")),s.style.transform=` scale(1) rotate(${parseFloat(t.getAttribute("chart:rotate"))}deg)`;e=(parseFloat(t.getAttribute("chart:value"))-this.options.margin)/100*s.getTotalLength();return s.setAttribute("stroke-dasharray",e+", "+s.getTotalLength()),t.classList.contains(this.classes.pathActive)?s.classList.toggle(this.classes.borderShow):s.style.strokeWidth="0",s};_getSettings(){return{options:this.options,data:this.data}}_getChart=()=>this.chart;createRandomHexNumber=t=>[...Array(t)].map(()=>Math.floor(16*Math.random()).toString(16)).join("")}export{BasicDoughnutChart};